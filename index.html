<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Schwimmbad Aufsicht & Auto-Generator</title>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
    background: #f2f2f2;
    margin: 10px;
}
h1, h2 {
    text-align: center;
}
.section {
    background: #fff;
    border-radius: 12px;
    padding: 10px;
    margin-bottom: 15px;
}
.kid {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    border-bottom: 1px solid #ddd;
    font-size: 18px;
}
.kid:last-child { border-bottom: none; }
input[type="checkbox"] { width: 26px; height: 26px; }
.time {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    margin: 10px 0;
}
.counter {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 10px;
}
button {
    width: 100%;
    padding: 12px;
    font-size: 18px;
    border-radius: 10px;
    border: none;
    background: #007aff;
    color: white;
    margin-top: 8px;
}
.car {
    font-size: 16px;
    margin-top: 6px;
}
</style>
</head>

<body>

<h1>üèä Schwimmbad & üöó Mitfahrliste</h1>

<!-- KINDER AUSWAHL -->
<div class="section">
<h2>Kinder dabei</h2>
<div class="counter">Anzahl: <span id="totalCount">0</span></div>
<div id="kidSelect"></div>
</div>

<!-- AUTO GENERATOR -->
<div class="section">
<h2>üöó Auto-Generator</h2>
<button onclick="generateCars()">üîÅ Namen neu generieren</button>
<div id="cars"></div>
</div>

<!-- CHECKLISTEN -->
<div id="checklists"></div>

<script>
const kids = [
"Aos","Ahmet","Efe","David","Kiril","Semih","Jonas","Jannik",
"Julian","Elias","Mario","Flitzer","Paul","Noel","Piot","Malik"
];

const times = [
"10:00","10:30","11:00","11:30","12:00","12:30",
"13:00","13:30","14:00","14:30","15:00","15:30",
"16:00","16:30","17:00","17:30","18:00"
];

const storageKey = "schwimmbadAutoCheck";
const data = JSON.parse(localStorage.getItem(storageKey)) || {
    selected: {},
    checks: {}
};

// KINDER AUSWAHL
const selectDiv = document.getElementById("kidSelect");
kids.forEach(kid => {
    const checked = data.selected[kid] ? "checked" : "";
    selectDiv.innerHTML += `
        <div class="kid">
            <span>${kid}</span>
            <input type="checkbox" ${checked}
                onchange="toggleKid('${kid}',this.checked)">
        </div>
    `;
});

// AUSWAHL HANDLING
function toggleKid(kid,val){
    data.selected[kid]=val;
    localStorage.setItem(storageKey,JSON.stringify(data));
    render();
}

// CHECKLISTEN
function render(){
    document.getElementById("totalCount").innerText =
        Object.values(data.selected).filter(v=>v).length;

    const container = document.getElementById("checklists");
    container.innerHTML="";

    times.forEach(time=>{
        const sec=document.createElement("div");
        sec.className="section";
        let html=`<div class="time">${time}</div>`;

        kids.filter(k=>data.selected[k]).forEach(kid=>{
            const checked = data.checks?.[time]?.[kid] ? "checked" : "";
            html+=`
            <div class="kid">
                <span>${kid}</span>
                <input type="checkbox" ${checked}
                onchange="saveCheck('${time}','${kid}',this.checked)">
            </div>`;
        });

        sec.innerHTML=html;
        container.appendChild(sec);
    });

    localStorage.setItem(storageKey,JSON.stringify(data));
}

function saveCheck(time,kid,val){
    if(!data.checks[time]) data.checks[time]={};
    data.checks[time][kid]=val;
    localStorage.setItem(storageKey,JSON.stringify(data));
}

// AUTO GENERATOR (NEU MISCHEN)
function shuffle(array){
    for(let i=array.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [array[i],array[j]]=[array[j],array[i]];
    }
}

function generateCars(){
    const active = kids.filter(k=>data.selected[k]);

    let car1=["Efe"];
    let car2=["Jannik","Julian"];
    let car3=["Jonas"];

    let rest = active.filter(k =>
        !car1.includes(k) &&
        !car2.includes(k) &&
        !car3.includes(k)
    );

    shuffle(rest);

    rest.forEach(k=>{
        const smallest=[car1,car2,car3].sort((a,b)=>a.length-b.length)[0];
        smallest.push(k);
    });

    document.getElementById("cars").innerHTML=`
        <div class="car"><strong>Auto Efe:</strong> ${car1.join(", ")}</div>
        <div class="car"><strong>Auto Jannik & Julian:</strong> ${car2.join(", ")}</div>
        <div class="car"><strong>Auto Jonas:</strong> ${car3.join(", ")}</div>
    `;
}

// START
render();

// ERINNERUNG (nur wenn offen)
setInterval(()=>{
    alert("‚è∞ Kontrolle: Kinder abhaken!");
},30*60*1000);
</script>

</body>
</html>
